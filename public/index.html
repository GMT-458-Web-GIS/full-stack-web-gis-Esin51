<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Pati Takip & GIS ğŸ¾</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root { --primary: #e67e22; --neon-border: #8d4004; }
        body { font-family: 'Poppins', sans-serif; margin: 0; background: #fdfdfd; }
        
        #landing-page { height: 100vh; display: flex; justify-content: center; align-items: center; background-image: url('images/bg-bottom.png'); background-repeat: no-repeat; background-position: bottom center; background-size: 100% auto; background-attachment: fixed; }
        .hero-box { background: rgba(255, 255, 255, 0.95); padding: 50px; border-radius: 30px; border: 4px solid var(--neon-border); text-align: center; max-width: 600px; }
        .entrance-list { text-align: left; font-size: 14px; margin: 20px 0; line-height: 1.6; }

        #form-page, #map-page { display: none; min-height: 100vh; flex-direction: column; align-items: center; padding: 40px 20px; background-image: url('images/bg-bottom.png'); background-repeat: no-repeat; background-position: bottom center; background-size: 100% auto; background-attachment: fixed; }
        .tabs { display: flex; background: rgba(255,255,255,0.9); padding: 5px; border-radius: 15px; margin-bottom: 25px; width: 100%; max-width: 450px; }
        .tab-btn { flex: 1; padding: 12px; border: none; background: transparent; border-radius: 12px; cursor: pointer; font-weight: 600; color: #666; transition: 0.3s; }
        .tab-btn.active { background: white; color: var(--primary); box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .neon-frame { background: white; padding: 35px; border-radius: 30px; border: 6px solid var(--neon-border); box-shadow: 0 0 40px rgba(230, 126, 34, 0.4); width: 100%; max-width: 480px; }
        
        #map-container { display: flex; width: 95%; max-width: 1300px; height: 600px; gap: 15px; }
        #mainMap { flex: 2; border-radius: 25px; border: 8px solid white; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        #side-panel { flex: 1; background: white; border-radius: 25px; padding: 20px; border: 4px solid var(--neon-border); overflow-y: auto; display: none; }
        
        .comment-box { background: #fdf2e9; padding: 10px; border-radius: 10px; margin-top: 10px; font-size: 13px; border-left: 5px solid var(--primary); animation: fadeIn 0.4s ease-out; position: relative; }
        .comment-img { width: 100%; border-radius: 8px; margin-top: 5px; }
        .comment-actions { margin-top: 5px; display: flex; gap: 10px; justify-content: flex-end; }
        .action-btn { background: none; border: none; font-size: 11px; cursor: pointer; color: #666; text-decoration: underline; }
        .action-btn:hover { color: var(--primary); }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeOut { from { opacity: 1; transform: scale(1); } to { opacity: 0; transform: scale(0.9); } }

        .custom-marker { width: 50px; height: 50px; border-radius: 50%; border: 3px solid #fff; background-size: cover; background-repeat: no-repeat; background-position: center center; box-shadow: 0 0 15px rgba(0,0,0,0.4); position: relative; background-color: #ddd; }
        .custom-marker::after { content: ''; position: absolute; bottom: -12px; left: 50%; transform: translateX(-50%); border-left: 8px solid transparent; border-right: 8px solid transparent; border-top: 12px solid #fff; }
        .marker-fresh { border-color: #2ecc71 !important; } .marker-fresh::after { border-top-color: #2ecc71 !important; }
        .marker-old { border-color: #e74c3c !important; } .marker-old::after { border-top-color: #e74c3c !important; }
        
        input, select, textarea { width: 100%; padding: 12px; margin-bottom: 12px; border: 1px solid #ddd; border-radius: 10px; box-sizing: border-box; }
        .btn-save { width: 100%; background: var(--primary); color: white; border: none; padding: 15px; border-radius: 12px; font-size: 18px; font-weight: bold; cursor: pointer; }
        .btn-maps { background: #4285F4; color: white; width: 100%; border: none; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; margin-bottom: 10px; text-decoration: none; display: inline-block; text-align: center; box-sizing: border-box; }
        .btn-delete { background: #e74c3c; color: white; width: 100%; border: none; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 20px; }

        #auth-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 9999; display: flex; justify-content: center; align-items: center; }
        .auth-box { background: white; padding: 30px; border-radius: 30px; max-width: 400px; width: 90%; border: 4px solid var(--neon-border); }
    </style>
</head>
<body>

    <div id="auth-modal">
        <div class="auth-box">
            <h2 style="text-align:center; color:var(--neon-border); font-family:'DM Serif Display';">ğŸ›¡ï¸ Ãœye GiriÅŸi</h2>
            <div id="register-section">
                <input type="text" id="regName" placeholder="Ad Soyad">
                <input type="email" id="regEmail" placeholder="E-posta">
                <input type="password" id="regPass" placeholder="Åifre OluÅŸtur"> <input type="tel" id="regTel" placeholder="Telefon No">
                <label style="font-size:12px; font-weight:bold; display:block; margin-bottom:5px;">ğŸ“¸ Selfie FotoÄŸrafÄ±nÄ±z (GÃ¼venlik Ä°Ã§in):</label>
                <input type="file" id="regSelfie" accept="image/*">
                <div style="margin: 10px 0; font-size: 12px; display: flex; align-items: center; gap: 10px;">
                    <input type="checkbox" id="kvkkCheck" name="kvkk" style="width: auto; margin: 0;">
                    <label for="kvkkCheck">KVKK ÅartlarÄ±nÄ± okudum ve kabul ediyorum.</label>
                </div>
                <button onclick="kayitOl()" class="btn-save">KayÄ±t Ol</button>
                <button onclick="toggleAuth(false)" style="background:none; border:none; color:blue; width:100%; margin-top:10px; cursor:pointer; font-size:13px;">Zaten Ã¼yeyim, giriÅŸ yap</button>
            </div>
            <div id="login-section" style="display:none;">
                <input type="email" id="loginEmail" placeholder="E-posta adresiniz">
                <input type="password" id="loginPass" placeholder="Åifreniz"> <button onclick="girisYap()" class="btn-save">GiriÅŸ Yap</button>
                <button onclick="toggleAuth(true)" style="background:none; border:none; color:blue; width:100%; margin-top:10px; cursor:pointer;">Yeni kayÄ±t oluÅŸtur</button>
            </div>
        </div>
    </div>

    <div id="landing-page">
        <div class="hero-box">
            <h1 style="font-family:'DM Serif Display'; font-size:38px; color:var(--neon-border); margin:0;">Pati Takip Sistemi ğŸ¾</h1>
            <div id="user-info" style="font-size:14px; margin:10px; font-weight:bold; color:var(--primary);"></div>
            <div class="entrance-list"><b>KullanÄ±m Rehberi:</b><br>â€¢ Haritadan konum seÃ§ip kayÄ±t yap.<br>â€¢ ğŸŸ¢ <b>YeÅŸil:</b> Son 3 gÃ¼n gÃ¼ncel.<br>â€¢ ğŸ”´ <b>KÄ±rmÄ±zÄ±:</b> Besleme yapÄ±lmadÄ±!</div>
            <div style="display: flex; gap: 10px; justify-content: center;">
                <button onclick="gecFormSayfasi()" class="btn-save" style="padding:15px 30px; border-radius:50px;">Yeni Pati Ekle â†’</button>
                <button onclick="gecHaritaSayfasi()" style="background:#3498db; color:white; border:none; padding:15px 30px; border-radius:50px; font-size:18px; font-weight:bold; cursor:pointer;">HaritayÄ± GÃ¶r</button>
                <button onclick="logout()" style="background:#666; color:white; border:none; padding:10px; border-radius:50px; cursor:pointer;">Ã‡Ä±kÄ±ÅŸ</button>
            </div>
        </div>
    </div>

    <div id="form-page">
        <div class="tabs">
            <button id="tabPati" class="tab-btn active" onclick="sekmeDegis('pati')">ğŸ¾ Patiler</button>
            <button id="tabBesleme" class="tab-btn" onclick="sekmeDegis('besleme')">ğŸ² Besleme NoktalarÄ±</button>
        </div>
        <div class="neon-frame">
            <h2 id="formTitle" style="text-align:center;">Yeni Pati Ekle</h2>
            
            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                <input type="text" id="addressInput" placeholder="Adres ara (Ã–rn: AnÄ±tkabir, Ankara)" style="margin:0; flex: 1;">
                <button type="button" onclick="searchAddress()" class="btn-save" style="width: auto; padding: 0 20px; font-size: 14px;">Bul ğŸ”</button>
            </div>
            
            <div id="miniMap" style="height:200px; border-radius:15px; margin-bottom:15px; border:1px solid #ddd;"></div>
            
            <form id="mainForm">
                <input type="hidden" id="lat" name="lat"> 
                <input type="hidden" id="lng" name="lng">
                <input type="text" id="name" name="ad" placeholder="BÃ¶lge / Konum Ä°smi (Ã–rn: Elmar Towers Ã–nÃ¼)" required>
                
                <div id="patiFields">
                    <input type="text" id="hayvanAdi" name="hayvanAdi" placeholder="HayvanÄ±n AdÄ± (Varsa: Boncuk, Pamuk vb.)">
                    
                    <div style="display:flex; gap:10px; align-items: flex-start;">
                        <div style="flex:1;">
                            <select id="tur" name="tur" onchange="turKontrol(this)"><option value="Kedi">Kedi</option><option value="KÃ¶pek">KÃ¶pek</option><option value="KuÅŸ">KuÅŸ</option><option value="DiÄŸer">DiÄŸer...</option></select>
                            <input type="text" id="turDiger" placeholder="Hangi Hayvan?" style="display:none; margin-top:5px; background:#fffaf0; border:1px solid var(--primary);">
                        </div>
                        <input type="text" id="yas" name="yas" placeholder="YaÅŸ" style="flex:1;">
                    </div>
                    <input type="text" id="sahip" name="sahip" placeholder="Sorumlu KiÅŸi">
                </div>
                
                <div id="beslemeFields" style="display:none;"><input type="text" id="besleyenKisi" name="besleyenKisi" placeholder="GÃ¶nÃ¼llÃ¼"></div>
                <textarea id="notlar" name="aciklama" placeholder="Ã–zel notlar..."></textarea>
                
                <input type="file" id="fileInput" name="resim" accept="image/*">
                
                <button type="submit" class="btn-save">Kaydet</button>
            </form>
            
            <div style="display: flex; gap: 10px; margin-top: 15px;">
                <button onclick="gecLandingSayfasi()" style="flex:1; background:#7f8c8d; color:white; border:none; padding:12px; border-radius:12px; cursor:pointer; font-weight:bold;">â† Geri</button>
                <button onclick="gecHaritaSayfasi()" style="flex:1; background:#3498db; color:white; border:none; padding:12px; border-radius:12px; cursor:pointer; font-weight:bold;">Harita â†’</button>
            </div>
        </div>
    </div>

    <div id="map-page">
        <div id="map-container">
            <div id="mainMap"></div>
            <div id="side-panel">
                <div id="panelContent"></div>
            </div>
        </div>
        <button onclick="gecLandingSayfasi()" style="margin-top:20px; padding:10px 20px; border-radius:10px; background:var(--neon-border); color:white; border:none; cursor:pointer;">Ana Sayfa</button>
    </div>

        <!-- Leaflet JS mutlaka kalsÄ±n -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Bizim JS dosyamÄ±z -->
    <script src="app.js"></script>
</body>
</html>

